!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).lazyframe=e()}(this,function(){"use strict";function o(){return(o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n,i=arguments[e];for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}var u,s,r,a;function l(e){var n,i=this;e instanceof HTMLElement==!1||e.classList.contains("lazyframe--loaded")||((n={el:e,settings:function(t){var e=Array.prototype.slice.apply(t.attributes).filter(function(t){return""!==t.value}).reduce(function(t,e){return t[0===e.name.indexOf("data-")?e.name.split("data-")[1]:e.name]=e.value,t},{}),t=o({},u,e,{y:t.offsetTop,parameters:function(t){t=t.split("?");return t[1]?-1!==(t=t[1]).indexOf("autoplay")?t:t+"&autoplay=1":"autoplay=1"}(e.src)});t.vendor&&(e=t.src.match(a.regex[t.vendor]),t.id=a.condition[t.vendor](e));return t}(e)}).el.addEventListener("click",function(){n.el.appendChild(n.iframe);var t=e.querySelectorAll("iframe");n.settings.onAppend.call(i,t[0])}),u.lazyload?d(n):c(n,n.settings.thumbnail))}function c(n){var e,i,o,t,r=this;!(t=n.settings).vendor||t.title&&t.thumbnail||!("youtube"!==t.vendor&&"youtube_nocookie"!==t.vendor||t.apikey)?d(n,!0):(e=n,i=function(t,e){t||(t=e[0],(e=e[1]).settings.title||(e.settings.title=a.response[e.settings.vendor].title(t)),e.settings.thumbnail||(t=a.response[e.settings.vendor].thumbnail(t),e.settings.thumbnail=t,n.settings.onThumbnailLoad.call(r,t)),d(e,!0))},t=a.endpoints[e.settings.vendor](e.settings),(o=new XMLHttpRequest).open("GET",t,!0),o.onload=function(){var t;200<=o.status&&o.status<400?(t=JSON.parse(o.responseText),i(null,[t,e])):i(!0)},o.onerror=function(){i(!0)},o.send())}function d(t,e){var n;t.iframe=function(t){var e=document.createDocumentFragment(),n=document.createElement("iframe");t.vendor&&(t.src=a.src[t.vendor](t));n.setAttribute("id","lazyframe-".concat(t.id)),n.setAttribute("src",t.src),n.setAttribute("frameborder",0),n.setAttribute("allowfullscreen",""),"vine"===t.vendor&&((t=document.createElement("script")).setAttribute("src","https://platform.vine.co/static/scripts/embed.js"),e.appendChild(t));return e.appendChild(n),e}(t.settings),t.settings.thumbnail&&e&&(t.el.style.backgroundImage="url(".concat(t.settings.thumbnail,")")),t.settings.title&&0===t.el.children.length&&(n=document.createDocumentFragment(),(e=document.createElement("span")).className="lazyframe__title",e.innerHTML=t.settings.title,n.appendChild(e),t.el.appendChild(n)),u.lazyload||(t.el.classList.add("lazyframe--loaded"),t.settings.onLoad.call(this,t),s.push(t)),t.settings.initialized||s.push(t)}return r={vendor:void 0,id:void 0,src:void 0,thumbnail:void 0,title:void 0,apikey:void 0,initialized:!(s=[]),parameters:void 0,y:void 0,debounce:250,lazyload:!0,initinview:!1,onLoad:function(t){},onAppend:function(t){},onThumbnailLoad:function(t){}},a={regex:{youtube_nocookie:/(?:youtube-nocookie\.com\/\S*(?:(?:\/e(?:mbed))?\/|watch\?(?:\S*?&?v\=)))([a-zA-Z0-9_-]{6,11})/,youtube:/(?:youtube\.com\/\S*(?:(?:\/e(?:mbed))?\/|watch\?(?:\S*?&?v\=))|youtu\.be\/)([a-zA-Z0-9_-]{6,11})/,vimeo:/vimeo\.com\/(?:video\/)?([0-9]*)(?:\?|)/,vine:/vine.co\/v\/(.*)/},condition:{youtube:function(t){return!(!t||11!=t[1].length)&&t[1]},youtube_nocookie:function(t){return!(!t||11!=t[1].length)&&t[1]},vimeo:function(t){return!!(t&&9===t[1].length||8===t[1].length)&&t[1]},vine:function(t){return!(!t||11!==t[1].length)&&t[1]}},src:{youtube:function(t){return"https://www.youtube.com/embed/".concat(t.id,"/?").concat(t.parameters)},youtube_nocookie:function(t){return"https://www.youtube-nocookie.com/embed/".concat(t.id,"/?").concat(t.parameters)},vimeo:function(t){return"https://player.vimeo.com/video/".concat(t.id,"/?").concat(t.parameters)},vine:function(t){return"https://vine.co/v/".concat(t.id,"/embed/simple")}},endpoints:{youtube:function(t){return"https://www.googleapis.com/youtube/v3/videos?id=".concat(t.id,"&key=").concat(t.apikey,"&fields=items(snippet(title,thumbnails))&part=snippet")},youtube_nocookie:function(t){return"https://www.googleapis.com/youtube/v3/videos?id=".concat(t.id,"&key=").concat(t.apikey,"&fields=items(snippet(title,thumbnails))&part=snippet")},vimeo:function(t){return"https://vimeo.com/api/oembed.json?url=https%3A//vimeo.com/".concat(t.id)},vine:function(t){return"https://vine.co/oembed.json?url=https%3A%2F%2Fvine.co%2Fv%2F".concat(t.id)}},response:{youtube:{title:function(t){return t.items[0].snippet.title},thumbnail:function(t){t=t.items[0].snippet.thumbnails;return(t.maxres||t.standard||t.high||t.medium||t.default).url}},youtube_nocookie:{title:function(t){return t.items[0].snippet.title},thumbnail:function(t){t=t.items[0].snippet.thumbnails;return(t.maxres||t.standard||t.high||t.medium||t.default).url}},vimeo:{title:function(t){return t.title},thumbnail:function(t){return t.thumbnail_url}},vine:{title:function(t){return t.title},thumbnail:function(t){return t.thumbnail_url}}}},function(t){if(u=o({},r,arguments.length<=1?void 0:arguments[1]),"string"==typeof t)for(var e=document.querySelectorAll(t),n=0;n<e.length;n++)l(e[n]);else if(void 0===t.length)l(t);else if(1<t.length)for(var i=0;i<t.length;i++)l(t[i]);else l(t[0]);u.lazyload&&function(){function t(t,e){t.settings.initialized=!0,t.el.classList.add("lazyframe--loaded"),i--,c(t),t.settings.initinview&&t.el.click(),t.settings.onLoad.call(n,t)}var n=this,e=window.innerHeight,i=s.length;s.filter(function(t){return t.settings.y<e}).forEach(t);var o=function(i,o,r){var a;return function(){var t=this,e=arguments,n=r&&!a;clearTimeout(a),a=setTimeout(function(){a=null,r||i.apply(t,e)},o),n&&i.apply(t,e)}}(function(){a=r<window.pageYOffset,r=window.pageYOffset,a&&s.filter(function(t){return t.settings.y<e+r&&!1===t.settings.initialized}).forEach(t),0===i&&window.removeEventListener("scroll",o,!1)},u.debounce),r=0,a=!1;window.addEventListener("scroll",o,!1)}()}});
//# sourceMappingURL=lazyframe.min.js.map
